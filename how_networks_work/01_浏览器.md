# 1 生成 HTTP 请求
- 浏览器的第一步工作就是***对 URL 进行解析***。
- 浏览器常用来访问 Web 服务器，也可以用来在 FTP 服务器上下载和上传文件，同时也具备电子邮件客户端的功能。

![url_format](src/url_format.png)
- 不同的服务器程序会使用不同的编号，例如 Web 是 80，邮件是 25 等。
- 在访问 `file:` 的 URL 时不使用网络。
- 以 `/` 结尾代表后面本来应该有的文件名被省略了。我们会在服务器上事先设置好文件名省略时要访问的默认文件名。这个设置根据服务器不同而不同，大多数情况下是 index.html 或者 default.htm 之类的文件名。
    - `/` 也可省略，如 `http://www.lab.glasscom.com`。
- `http://www.lab.glasscom.com/whatisthis`：如果 Web 服务器上存在名为 `whatisthis` 的文件，则将 `whatisthis` 作为文件名来处理；如果存在名为 `whatisthis` 的目录，则将 `whatisthis` 作为目录名来处理。
    - 我们无法创建两个名字相同的文件和目录，因此不可能既有一个名为 `whatisthis` 的文件，同时又有一个名为 `whatisthis` 的目录。只要查询一下磁盘中的文件和目录，就可以知道 `whatisthis` 究竟是一个文件还是一个目录了，并不会产生歧义。
- HTTP 协议定义了客户端和服务器之间交互的消息内容和步骤。首先，客户端会向服务器发送请求消息。请求消息中包含的内容是“对什么”和“进行怎样的操作”两个部分。
    - 其中相当于“对什么”的部分称为 URI。一般来说，URI 的内容是一个存放网页数据的文件名或者是一个 CGI 程序的文件名，例如 `/dir1/file1.html`，`/dir1/program1.cgi`。URI 不仅限于此，也可以直接使用 `http:` 开头的 URL 来作为 URI。换句话说就是，这里可以写各种**访问目标**，而这些访问目标统称为 URI。
        - URI：Uniform Resource Identifier，统一资源标识符。
        - CGI 程序：对 Web 服务器程序调用其他程序的规则所做的定义就是 CGI（Common Gateway Interface，通用网关接口），而按照 CGI 规范来工作的程序就称为 CGI 程序。
    - 相当于接下来“进行怎样的操作”的部分称为方法。方法表示需要让 Web 服务器完成怎样的工作。
        ![](src/http_methods.png)
    - HTTP 消息中还有一些用来表示附加信息的头字段。客户端向 Web 服务器发送数据时，会先发送头字段，然后再发送数据。头字段属于可有可无的附加信息。
- 使用 POST 方法时，URI 会指向 Web 服务器中运行的一个应用程序的文件名，典型的例子包括 `index.cgi`，`index.php` 等。在请求消息中，除了方法和 URI 之外，还要加上传递给应用程序和脚本的数据。
- 对 URL 进行解析之后，浏览器确定了 Web 服务器和文件名，接下来就是根据这些信息来***生成 HTTP 请求消息***。
![](src/HTTP_msg.png)
- 消息体的格式会通过消息头中的 Content-Type 字段来定义（MIME 类型）。
- 我们的场景是在地址栏中输入网址并显示网页，因此这里应该使用 GET 方法。点击超级链接的场景中也是使用 GET 方法。如果是表单，在 HTML 源代码中会在表单的属性中指定使用哪种方法来发送请求，可能是 GET 也可能是 POST。
    ![](src/GET_POST.png)
    - GET 方法能够发送的数据只有几百个字节，如果表单中的数据超过这一长度，则必须使用 POST 方法来发送。
- 尽管通过第一行我们就可以大致理解请求的内容，但有些情况下还需要一些额外的详细信息，而消息头的功能就是用来存放这些信息。
- 消息头的规格中定义了很多项目，如日期、客户端支持的数据类型、语言、压缩格式、客户端和服务器的软件名称和版本、数据有效期和最后更新时间等。
    ![](src/HTTP_headers_1.png)
    ![](src/HTTP_headers_2.png)
    ![](src/HTTP_headers_3.png)
- 在使用 `GET` 方法的情况下，仅凭方法和 URI，Web 服务器就能够判断需要进行怎样的操作，因此消息体中不需要填写任何数据。当使用 POST 方法时，需要将表单中填写的信息写在消息体中。
# 2 向 DNS 服务器查询 Web 服务器的 IP 地址
# 3 全世界 DNS 服务器接力
# 4 委托协议栈发送消息
continue at 20